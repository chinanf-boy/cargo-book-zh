<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Registries - Rust Cargo 官书（非官方翻译)</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Cargo ">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.zh.html">Introduction</a></li><li class="chapter-item expanded "><a href="../getting-started/index.zh.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../getting-started/installation.zh.html"><strong aria-hidden="true">1.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../getting-started/first-steps.zh.html"><strong aria-hidden="true">1.2.</strong> First Steps with Cargo</a></li></ol></li><li class="chapter-item expanded "><a href="../guide/index.zh.html"><strong aria-hidden="true">2.</strong> Cargo Guide</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../guide/why-cargo-exists.zh.html"><strong aria-hidden="true">2.1.</strong> Why Cargo Exists</a></li><li class="chapter-item expanded "><a href="../guide/creating-a-new-project.zh.html"><strong aria-hidden="true">2.2.</strong> Creating a New Package</a></li><li class="chapter-item expanded "><a href="../guide/working-on-an-existing-project.zh.html"><strong aria-hidden="true">2.3.</strong> Working on an Existing Package</a></li><li class="chapter-item expanded "><a href="../guide/dependencies.zh.html"><strong aria-hidden="true">2.4.</strong> Dependencies</a></li><li class="chapter-item expanded "><a href="../guide/project-layout.zh.html"><strong aria-hidden="true">2.5.</strong> Package Layout</a></li><li class="chapter-item expanded "><a href="../guide/cargo-toml-vs-cargo-lock.zh.html"><strong aria-hidden="true">2.6.</strong> Cargo.toml vs Cargo.lock</a></li><li class="chapter-item expanded "><a href="../guide/tests.zh.html"><strong aria-hidden="true">2.7.</strong> Tests</a></li><li class="chapter-item expanded "><a href="../guide/continuous-integration.zh.html"><strong aria-hidden="true">2.8.</strong> Continuous Integration</a></li><li class="chapter-item expanded "><a href="../guide/cargo-home.zh.html"><strong aria-hidden="true">2.9.</strong> Cargo Home</a></li><li class="chapter-item expanded "><a href="../guide/build-cache.zh.html"><strong aria-hidden="true">2.10.</strong> Build Cache</a></li></ol></li><li class="chapter-item expanded "><a href="../reference/index.zh.html"><strong aria-hidden="true">3.</strong> Cargo Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/specifying-dependencies.zh.html"><strong aria-hidden="true">3.1.</strong> Specifying Dependencies</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/overriding-dependencies.zh.html"><strong aria-hidden="true">3.1.1.</strong> Overriding Dependencies</a></li></ol></li><li class="chapter-item expanded "><a href="../reference/manifest.zh.html"><strong aria-hidden="true">3.2.</strong> The Manifest Format</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/cargo-targets.zh.html"><strong aria-hidden="true">3.2.1.</strong> Cargo Targets</a></li></ol></li><li class="chapter-item expanded "><a href="../reference/workspaces.zh.html"><strong aria-hidden="true">3.3.</strong> Workspaces</a></li><li class="chapter-item expanded "><a href="../reference/features.zh.html"><strong aria-hidden="true">3.4.</strong> Features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/features-examples.zh.html"><strong aria-hidden="true">3.4.1.</strong> Features Examples</a></li></ol></li><li class="chapter-item expanded "><a href="../reference/profiles.zh.html"><strong aria-hidden="true">3.5.</strong> Profiles</a></li><li class="chapter-item expanded "><a href="../reference/config.zh.html"><strong aria-hidden="true">3.6.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="../reference/environment-variables.zh.html"><strong aria-hidden="true">3.7.</strong> Environment Variables</a></li><li class="chapter-item expanded "><a href="../reference/build-scripts.zh.html"><strong aria-hidden="true">3.8.</strong> Build Scripts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/build-script-examples.zh.html"><strong aria-hidden="true">3.8.1.</strong> Build Script Examples</a></li></ol></li><li class="chapter-item expanded "><a href="../reference/publishing.zh.html"><strong aria-hidden="true">3.9.</strong> Publishing on crates.io</a></li><li class="chapter-item expanded "><a href="../reference/pkgid-spec.zh.html"><strong aria-hidden="true">3.10.</strong> Package ID Specifications</a></li><li class="chapter-item expanded "><a href="../reference/source-replacement.zh.html"><strong aria-hidden="true">3.11.</strong> Source Replacement</a></li><li class="chapter-item expanded "><a href="../reference/external-tools.zh.html"><strong aria-hidden="true">3.12.</strong> External Tools</a></li><li class="chapter-item expanded "><a href="../reference/registries.zh.html" class="active"><strong aria-hidden="true">3.13.</strong> Registries</a></li><li class="chapter-item expanded "><a href="../reference/resolver.zh.html"><strong aria-hidden="true">3.14.</strong> Dependency Resolution</a></li><li class="chapter-item expanded "><a href="../reference/semver.zh.html"><strong aria-hidden="true">3.15.</strong> SemVer Compatibility</a></li><li class="chapter-item expanded "><a href="../reference/future-incompat-report.zh.html"><strong aria-hidden="true">3.16.</strong> Future incompat report</a></li><li class="chapter-item expanded "><a href="../reference/unstable.zh.html"><strong aria-hidden="true">3.17.</strong> Unstable Features</a></li></ol></li><li class="chapter-item expanded "><a href="../commands/index.zh.html"><strong aria-hidden="true">4.</strong> Cargo Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/general-commands.zh.html"><strong aria-hidden="true">4.1.</strong> General Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/cargo.zh.html"><strong aria-hidden="true">4.1.1.</strong> cargo</a></li><li class="chapter-item expanded "><a href="../commands/cargo-help.zh.html"><strong aria-hidden="true">4.1.2.</strong> cargo help</a></li><li class="chapter-item expanded "><a href="../commands/cargo-version.zh.html"><strong aria-hidden="true">4.1.3.</strong> cargo version</a></li></ol></li><li class="chapter-item expanded "><a href="../commands/build-commands.zh.html"><strong aria-hidden="true">4.2.</strong> Build Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/cargo-bench.zh.html"><strong aria-hidden="true">4.2.1.</strong> cargo bench</a></li><li class="chapter-item expanded "><a href="../commands/cargo-build.zh.html"><strong aria-hidden="true">4.2.2.</strong> cargo build</a></li><li class="chapter-item expanded "><a href="../commands/cargo-check.zh.html"><strong aria-hidden="true">4.2.3.</strong> cargo check</a></li><li class="chapter-item expanded "><a href="../commands/cargo-clean.zh.html"><strong aria-hidden="true">4.2.4.</strong> cargo clean</a></li><li class="chapter-item expanded "><a href="../commands/cargo-doc.zh.html"><strong aria-hidden="true">4.2.5.</strong> cargo doc</a></li><li class="chapter-item expanded "><a href="../commands/cargo-fetch.zh.html"><strong aria-hidden="true">4.2.6.</strong> cargo fetch</a></li><li class="chapter-item expanded "><a href="../commands/cargo-fix.zh.html"><strong aria-hidden="true">4.2.7.</strong> cargo fix</a></li><li class="chapter-item expanded "><a href="../commands/cargo-run.zh.html"><strong aria-hidden="true">4.2.8.</strong> cargo run</a></li><li class="chapter-item expanded "><a href="../commands/cargo-rustc.zh.html"><strong aria-hidden="true">4.2.9.</strong> cargo rustc</a></li><li class="chapter-item expanded "><a href="../commands/cargo-rustdoc.zh.html"><strong aria-hidden="true">4.2.10.</strong> cargo rustdoc</a></li><li class="chapter-item expanded "><a href="../commands/cargo-test.zh.html"><strong aria-hidden="true">4.2.11.</strong> cargo test</a></li><li class="chapter-item expanded "><a href="../commands/cargo-report.zh.html"><strong aria-hidden="true">4.2.12.</strong> cargo report</a></li></ol></li><li class="chapter-item expanded "><a href="../commands/manifest-commands.zh.html"><strong aria-hidden="true">4.3.</strong> Manifest Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/cargo-generate-lockfile.zh.html"><strong aria-hidden="true">4.3.1.</strong> cargo generate-lockfile</a></li><li class="chapter-item expanded "><a href="../commands/cargo-locate-project.zh.html"><strong aria-hidden="true">4.3.2.</strong> cargo locate-project</a></li><li class="chapter-item expanded "><a href="../commands/cargo-metadata.zh.html"><strong aria-hidden="true">4.3.3.</strong> cargo metadata</a></li><li class="chapter-item expanded "><a href="../commands/cargo-pkgid.zh.html"><strong aria-hidden="true">4.3.4.</strong> cargo pkgid</a></li><li class="chapter-item expanded "><a href="../commands/cargo-tree.zh.html"><strong aria-hidden="true">4.3.5.</strong> cargo tree</a></li><li class="chapter-item expanded "><a href="../commands/cargo-update.zh.html"><strong aria-hidden="true">4.3.6.</strong> cargo update</a></li><li class="chapter-item expanded "><a href="../commands/cargo-vendor.zh.html"><strong aria-hidden="true">4.3.7.</strong> cargo vendor</a></li><li class="chapter-item expanded "><a href="../commands/cargo-verify-project.zh.html"><strong aria-hidden="true">4.3.8.</strong> cargo verify-project</a></li></ol></li><li class="chapter-item expanded "><a href="../commands/package-commands.zh.html"><strong aria-hidden="true">4.4.</strong> Package Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/cargo-init.zh.html"><strong aria-hidden="true">4.4.1.</strong> cargo init</a></li><li class="chapter-item expanded "><a href="../commands/cargo-install.zh.html"><strong aria-hidden="true">4.4.2.</strong> cargo install</a></li><li class="chapter-item expanded "><a href="../commands/cargo-new.zh.html"><strong aria-hidden="true">4.4.3.</strong> cargo new</a></li><li class="chapter-item expanded "><a href="../commands/cargo-search.zh.html"><strong aria-hidden="true">4.4.4.</strong> cargo search</a></li><li class="chapter-item expanded "><a href="../commands/cargo-uninstall.zh.html"><strong aria-hidden="true">4.4.5.</strong> cargo uninstall</a></li></ol></li><li class="chapter-item expanded "><a href="../commands/publishing-commands.zh.html"><strong aria-hidden="true">4.5.</strong> Publishing Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../commands/cargo-login.zh.html"><strong aria-hidden="true">4.5.1.</strong> cargo login</a></li><li class="chapter-item expanded "><a href="../commands/cargo-owner.zh.html"><strong aria-hidden="true">4.5.2.</strong> cargo owner</a></li><li class="chapter-item expanded "><a href="../commands/cargo-package.zh.html"><strong aria-hidden="true">4.5.3.</strong> cargo package</a></li><li class="chapter-item expanded "><a href="../commands/cargo-publish.zh.html"><strong aria-hidden="true">4.5.4.</strong> cargo publish</a></li><li class="chapter-item expanded "><a href="../commands/cargo-yank.zh.html"><strong aria-hidden="true">4.5.5.</strong> cargo yank</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../faq.zh.html"><strong aria-hidden="true">5.</strong> FAQ</a></li><li class="chapter-item expanded "><a href="../appendix/glossary.zh.html"><strong aria-hidden="true">6.</strong> Appendix: Glossary</a></li><li class="chapter-item expanded "><a href="../appendix/git-authentication.zh.html"><strong aria-hidden="true">7.</strong> Appendix: Git Authentication</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust Cargo 官书（非官方翻译)</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/chinanf-boy/cargo-book-zh/edit/master/src/reference/registries.zh.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="registries"><a class="header" href="#registries">Registries</a></h2>
<p>Cargo安装箱子并从“注册表”中获取依赖项。默认注册表是<a href="https://crates.io/">crates.io</a>.注册表包含一个“索引”，其中包含可用箱子的可搜索列表。注册表还可以提供web API，以支持直接从Cargo发布新箱子。</p>
<blockquote>
<p>注意：如果您对镜像或出售现有注册表感兴趣，请查看<a href="source-replacement.html">Source Replacement</a>.</p>
</blockquote>
<h3 id="using-an-alternate-registry"><a class="header" href="#using-an-alternate-registry">Using an Alternate Registry</a></h3>
<p>要使用注册表而不是<a href="https://crates.io/">crates.io</a>，必须将注册表的名称和索引URL添加到<a href="config.html"><code>.cargo/config.toml</code> file</a>这个<code>registries</code>表中的每个注册表都有一个键，例如：</p>
<pre><code class="language-toml">[registries]
my-registry = { index = &quot;https://my-intranet:8080/git/index&quot; }
</code></pre>
<p>这个<code>index</code>键应该是指向带有注册表索引的git存储库的URL。然后，箱子可以通过指定<code>registry</code>键和中该依赖项项中注册表名称的值<code>Cargo.toml</code>:</p>
<pre><code class="language-toml"># Sample Cargo.toml
[package]
name = &quot;my-project&quot;
version = &quot;0.1.0&quot;

[dependencies]
other-crate = { version = &quot;1.0&quot;, registry = &quot;my-registry&quot; }
</code></pre>
<p>与大多数配置值一样，可以使用环境变量而不是配置文件指定索引。例如，设置以下环境变量将完成与定义配置文件相同的任务：</p>
<pre><code class="language-ignore">CARGO_REGISTRIES_MY_REGISTRY_INDEX=https://my-intranet:8080/git/index
</code></pre>
<blockquote>
<p>注：<a href="https://crates.io/">crates.io</a>不接受依赖其他登记处箱子的包装。</p>
</blockquote>
<h3 id="publishing-to-an-alternate-registry"><a class="header" href="#publishing-to-an-alternate-registry">Publishing to an Alternate Registry</a></h3>
<p>如果注册表支持web API访问，那么包可以从Cargo直接发布到注册表。Cargo的几个命令，比如<a href="../commands/cargo-publish.html"><code>cargo publish</code></a>坐一会儿<code>--registry</code>命令行标志，指示要使用哪个注册表。例如，要在当前目录中发布包，请执行以下操作：</p>
<ol>
<li>
<p><code>cargo login --registry=my-registry</code></p>
<p>这只需要做一次。您必须输入从注册表网站检索到的机密API令牌。或者，令牌可以直接传递给服务器<code>publish</code>指挥<code>--token</code>命令行标志或带有注册表名称的环境变量，例如<code>CARGO_REGISTRIES_MY_REGISTRY_TOKEN</code>.</p>
</li>
<li>
<p><code>cargo publish --registry=my-registry</code></p>
</li>
</ol>
<p>而不是总是通过考试<code>--registry</code>命令行选项，可以在中设置默认注册表<a href="config.html"><code>.cargo/config.toml</code></a>和<code>registry.default</code>钥匙</p>
<p>设定<code>package.publish</code>输入<code>Cargo.toml</code>清单限制允许将包发布到哪些注册表。这有助于防止意外地将封闭源代码包发布到<a href="https://crates.io/">crates.io</a>。该值可以是注册表名列表，例如：</p>
<pre><code class="language-toml">[package]
# ...
publish = [&quot;my-registry&quot;]
</code></pre>
<p>这个<code>publish</code>价值也可能是<code>false</code>限制所有发布，这与空列表相同。</p>
<p>保存的身份验证信息<a href="../commands/cargo-login.html"><code>cargo login</code></a>存储在<code>credentials.toml</code>Cargo主目录中的文件（默认）<code>$HOME/.cargo</code>)。每个注册表都有一个单独的表，例如：</p>
<pre><code class="language-toml">[registries.my-registry]
token = &quot;854DvwSlUwEHtIo3kWy6x7UCPKHfzCmy&quot;
</code></pre>
<h3 id="running-a-registry"><a class="header" href="#running-a-registry">Running a Registry</a></h3>
<p>一个最小的注册表可以通过一个包含索引的git存储库和一个包含压缩文件的服务器来实现<code>.crate</code>创建的文件<a href="../commands/cargo-package.html"><code>cargo package</code></a>。用户将无法使用Cargo向其发布，但对于封闭环境而言，这可能就足够了。</p>
<p>支持发布的功能齐全的注册表还需要一个符合Cargo使用的API的web API服务。下面介绍了web API。</p>
<p>商业和社区项目可用于建立和运行注册表。查看<a href="https://github.com/rust-lang/cargo/wiki/Third-party-registries">https://github.com/rust-lang/cargo/wiki/Third-party-registries</a>查看可用内容的列表。</p>
<h3 id="index-format"><a class="header" href="#index-format">Index Format</a></h3>
<p>下面定义了索引的格式。偶尔会添加新功能，只有从引入它们的Cargo版本开始才能理解这些功能。旧版本的Cargo可能无法使用使用新功能的软件包。然而，旧包装的格式不应该改变，所以旧版本的Cargo应该能够使用它们。</p>
<p>索引存储在git存储库中，这样Cargo就可以高效地获取索引的增量更新。存储库的根目录中有一个名为<code>config.json</code>其中包含Cargo用于访问注册表的JSON信息。这是一个例子，说明<a href="https://crates.io/">crates.io</a>配置文件如下所示：</p>
<pre><code class="language-javascript">{
    &quot;dl&quot;: &quot;https://crates.io/api/v1/crates&quot;,
    &quot;api&quot;: &quot;https://crates.io&quot;
}
</code></pre>
<p>关键是：</p>
<ul>
<li>
<p><code>dl</code>：这是下载索引中列出的箱子的URL。该值可能具有以下标记，这些标记将替换为相应的值：</p>
<ul>
<li><code>{crate}</code>：箱子的名称。</li>
<li><code>{version}</code>：箱子版本。</li>
<li><code>{prefix}</code>：根据箱子名称计算的目录前缀。例如，一个名为<code>cargo</code>前缀为<code>ca/rg</code>.详情见下文。</li>
<li><code>{lowerprefix}</code>：的小写变体<code>{prefix}</code>.</li>
<li><code>{sha256-checksum}</code>：箱子的sha256校验和。</li>
</ul>
<p>如果不存在任何标记，则值<code>/{crate}/{version}/download</code>被附加到结尾。</p>
</li>
<li>
<p><code>api</code>：这是web API的基本URL。此键是可选的，但如果未指定，则可以使用以下命令：<a href="../commands/cargo-publish.html"><code>cargo publish</code></a>行不通。下面介绍web API。</p>
</li>
</ul>
<p>下载端点应发送<code>.crate</code>请求的包的文件。Cargo支持https、http和文件URL、http重定向、HTTP1和HTTP2。TLS支持的具体细节取决于Cargo运行的平台、Cargo的版本以及编译方式。</p>
<p>索引存储库的其余部分为每个包包含一个文件，其中文件名是包的小写名称。每个版本的软件包在文件中都有单独的一行。这些文件被组织在一层目录中：</p>
<ul>
<li>名称为1个字符的包被放置在名为<code>1</code>.</li>
<li>名为2个字符的包被放置在名为<code>2</code>.</li>
<li>具有3个字符名称的包被放置在目录中<code>3/{first-character}</code>哪里<code>{first-character}</code>是包名称的第一个字符。</li>
<li>所有其他包都存储在名为<code>{first-two}/{second-two}</code>其中，顶层目录是包名的前两个字符，下一个子目录是包名的第三个和第四个字符。例如<code>cargo</code>将存储在名为<code>ca/rg/cargo</code>.</li>
</ul>
<blockquote>
<p>注意：虽然索引文件名是小写的，但包含包名的字段<code>Cargo.toml</code>索引JSON数据区分大小写，可能包含大小写字符。</p>
</blockquote>
<p>上面的目录名是根据转换成小写的包名计算的；它由标记表示<code>{lowerprefix}</code>.当使用原始包名而不进行大小写转换时，生成的目录名由标记表示<code>{prefix}</code>.例如，包裹<code>MyCrate</code>会有一个<code>{prefix}</code>属于<code>My/Cr</code>还有<code>{lowerprefix}</code>属于<code>my/cr</code>.一般来说，使用<code>{prefix}</code>推荐超过<code>{lowerprefix}</code>，但每种选择都有利弊。使用<code>{prefix}</code>在不区分大小写的文件系统上，会导致（无害但不美观的）目录别名。例如<code>crate</code>和<code>CrateTwo</code>有<code>{prefix}</code>价值观<code>cr/at</code>和<code>Cr/at</code>; 这些在Unix机器上是不同的，但在Windows上是同一目录的别名。使用大小写规范化的目录可以避免别名，但在区分大小写的文件系统上，更难支持缺少大小写的旧版本的Cargo<code>{prefix}</code>/<code>{lowerprefix}</code>。例如，nginx重写规则可以轻松构建<code>{prefix}</code>但无法将大小写转换为构造<code>{lowerprefix}</code>.</p>
<p>注册中心应考虑对包索引中添加的包名称执行限制。Cargo本身允许使用任何名称<a href="../../std/primitive.char.html#method.is_alphanumeric">alphanumeric</a>, <code>-</code>或<code>_</code>角色。<a href="https://crates.io/">crates.io</a>施加了自身的限制，包括：</p>
<ul>
<li>仅允许使用ASCII字符。</li>
<li>只有字母数字，<code>-</code>和<code>_</code>角色。</li>
<li>第一个字符必须按字母顺序排列。</li>
<li>不区分大小写的碰撞检测。</li>
<li>防止分歧<code>-</code> vs <code>_</code>.</li>
<li>在特定长度下（最大64）。</li>
<li>拒绝保留名称，例如Windows特殊文件名，如“nul”。</li>
</ul>
<p>注册中心应考虑合并类似的限制，并考虑安全性的影响，例如<a href="https://en.wikipedia.org/wiki/IDN_homograph_attack">IDN homograph
attacks</a>以及其他方面的担忧<a href="https://www.unicode.org/reports/tr36/">UTR36</a>和<a href="https://www.unicode.org/reports/tr39/">UTS39</a>.</p>
<p>包文件中的每一行都包含一个JSON对象，该对象描述包的发布版本。下面是一个漂亮的打印示例，带有解释条目格式的注释。</p>
<pre><code class="language-javascript">{
    // The name of the package.
    // This must only contain alphanumeric, `-`, or `_` characters.
    &quot;name&quot;: &quot;foo&quot;,
    // The version of the package this row is describing.
    // This must be a valid version number according to the Semantic
    // Versioning 2.0.0 spec at https://semver.org/.
    &quot;vers&quot;: &quot;0.1.0&quot;,
    // Array of direct dependencies of the package.
    &quot;deps&quot;: [
        {
            // Name of the dependency.
            // If the dependency is renamed from the original package name,
            // this is the new name. The original package name is stored in
            // the `package` field.
            &quot;name&quot;: &quot;rand&quot;,
            // The SemVer requirement for this dependency.
            // This must be a valid version requirement defined at
            // https://doc.rust-lang.org/cargo/reference/specifying-dependencies.html.
            &quot;req&quot;: &quot;^0.6&quot;,
            // Array of features (as strings) enabled for this dependency.
            &quot;features&quot;: [&quot;i128_support&quot;],
            // Boolean of whether or not this is an optional dependency.
            &quot;optional&quot;: false,
            // Boolean of whether or not default features are enabled.
            &quot;default_features&quot;: true,
            // The target platform for the dependency.
            // null if not a target dependency.
            // Otherwise, a string such as &quot;cfg(windows)&quot;.
            &quot;target&quot;: null,
            // The dependency kind.
            // &quot;dev&quot;, &quot;build&quot;, or &quot;normal&quot;.
            // Note: this is a required field, but a small number of entries
            // exist in the crates.io index with either a missing or null
            // `kind` field due to implementation bugs.
            &quot;kind&quot;: &quot;normal&quot;,
            // The URL of the index of the registry where this dependency is
            // from as a string. If not specified or null, it is assumed the
            // dependency is in the current registry.
            &quot;registry&quot;: null,
            // If the dependency is renamed, this is a string of the actual
            // package name. If not specified or null, this dependency is not
            // renamed.
            &quot;package&quot;: null,
        }
    ],
    // A SHA256 checksum of the `.crate` file.
    &quot;cksum&quot;: &quot;d867001db0e2b6e0496f9fac96930e2d42233ecd3ca0413e0753d4c7695d289c&quot;,
    // Set of features defined for the package.
    // Each feature maps to an array of features or dependencies it enables.
    &quot;features&quot;: {
        &quot;extras&quot;: [&quot;rand/simd_support&quot;]
    },
    // Boolean of whether or not this version has been yanked.
    &quot;yanked&quot;: false,
    // The `links` string value from the package's manifest, or null if not
    // specified. This field is optional and defaults to null.
    &quot;links&quot;: null
}
</code></pre>
<p>除了<code>yanked</code>其值可能随时更改的字段。</p>
<h3 id="web-api"><a class="header" href="#web-api">Web API</a></h3>
<p>注册表可以在中定义的位置托管web API<code>config.json</code>支持下面列出的任何操作。</p>
<p>Cargo包括<code>Authorization</code>需要身份验证的请求的标头。标头值是API标记。如果令牌无效，服务器应使用403响应代码进行响应。用户需要访问注册中心的网站以获取代币，Cargo可以使用<a href="../commands/cargo-login.html"><code>cargo login</code></a>命令，或通过在命令行上传递令牌。</p>
<p>响应使用200响应代码表示成功和错误。Cargo查看JSON响应以确定是成功还是失败。故障响应有一个JSON对象，其结构如下：</p>
<pre><code class="language-javascript">{
    // Array of errors to display to the user.
    &quot;errors&quot;: [
        {
            // The error message as a string.
            &quot;detail&quot;: &quot;error message text&quot;
        }
    ]
}
</code></pre>
<p>服务器还可以使用404响应代码进行响应，以指示未找到请求的资源（例如，未知的箱子名称）。但是，使用200响应和<code>errors</code>对象允许注册表在需要时提供更详细的错误消息。</p>
<p>为了向后兼容，服务器应该忽略任何意外的查询参数或JSON字段。如果缺少JSON字段，则应假定该字段为空。端点的版本由<code>v1</code>路径的组件，Cargo负责处理将来需要的向后兼容性回退。</p>
<p>Cargo为所有请求设置以下标题：</p>
<ul>
<li><code>Content-Type</code>: <code>application/json</code></li>
<li><code>Accept</code>: <code>application/json</code></li>
<li><code>User-Agent</code>：Cargo版本，例如<code>cargo 1.32.0 (8610973aa 2019-01-02)</code>。用户可在配置值中对此进行修改。添加到1.29中。</li>
</ul>
<h4 id="publish"><a class="header" href="#publish">Publish</a></h4>
<ul>
<li>终点：<code>/api/v1/crates/new</code></li>
<li>方法：放</li>
<li>授权：包括</li>
</ul>
<p>发布端点用于发布箱子的新版本。服务器应验证箱子，使其可供下载，并将其添加到索引中。</p>
<p>Cargo发送的数据主体是：</p>
<ul>
<li>JSON数据长度的32位无符号小整数。</li>
<li>作为JSON对象的包元数据。</li>
<li>数据长度的32位无符号小整数<code>.crate</code>文件</li>
<li>这个<code>.crate</code>文件</li>
</ul>
<p>下面是JSON对象的注释示例。关于美国实施的一些限制的一些注释<a href="https://crates.io/">crates.io</a>仅用于说明可能进行的验证类型的一些建议，不应被视为限制的详尽列表<a href="https://crates.io/">crates.io</a>强加。</p>
<pre><code class="language-javascript">{
    // The name of the package.
    &quot;name&quot;: &quot;foo&quot;,
    // The version of the package being published.
    &quot;vers&quot;: &quot;0.1.0&quot;,
    // Array of direct dependencies of the package.
    &quot;deps&quot;: [
        {
            // Name of the dependency.
            // If the dependency is renamed from the original package name,
            // this is the original name. The new package name is stored in
            // the `explicit_name_in_toml` field.
            &quot;name&quot;: &quot;rand&quot;,
            // The semver requirement for this dependency.
            &quot;version_req&quot;: &quot;^0.6&quot;,
            // Array of features (as strings) enabled for this dependency.
            &quot;features&quot;: [&quot;i128_support&quot;],
            // Boolean of whether or not this is an optional dependency.
            &quot;optional&quot;: false,
            // Boolean of whether or not default features are enabled.
            &quot;default_features&quot;: true,
            // The target platform for the dependency.
            // null if not a target dependency.
            // Otherwise, a string such as &quot;cfg(windows)&quot;.
            &quot;target&quot;: null,
            // The dependency kind.
            // &quot;dev&quot;, &quot;build&quot;, or &quot;normal&quot;.
            &quot;kind&quot;: &quot;normal&quot;,
            // The URL of the index of the registry where this dependency is
            // from as a string. If not specified or null, it is assumed the
            // dependency is in the current registry.
            &quot;registry&quot;: null,
            // If the dependency is renamed, this is a string of the new
            // package name. If not specified or null, this dependency is not
            // renamed.
            &quot;explicit_name_in_toml&quot;: null,
        }
    ],
    // Set of features defined for the package.
    // Each feature maps to an array of features or dependencies it enables.
    // Cargo does not impose limitations on feature names, but crates.io
    // requires alphanumeric ASCII, `_` or `-` characters.
    &quot;features&quot;: {
        &quot;extras&quot;: [&quot;rand/simd_support&quot;]
    },
    // List of strings of the authors.
    // May be empty.
    &quot;authors&quot;: [&quot;Alice &lt;a@example.com&gt;&quot;],
    // Description field from the manifest.
    // May be null. crates.io requires at least some content.
    &quot;description&quot;: null,
    // String of the URL to the website for this package's documentation.
    // May be null.
    &quot;documentation&quot;: null,
    // String of the URL to the website for this package's home page.
    // May be null.
    &quot;homepage&quot;: null,
    // String of the content of the README file.
    // May be null.
    &quot;readme&quot;: null,
    // String of a relative path to a README file in the crate.
    // May be null.
    &quot;readme_file&quot;: null,
    // Array of strings of keywords for the package.
    &quot;keywords&quot;: [],
    // Array of strings of categories for the package.
    &quot;categories&quot;: [],
    // String of the license for the package.
    // May be null. crates.io requires either `license` or `license_file` to be set.
    &quot;license&quot;: null,
    // String of a relative path to a license file in the crate.
    // May be null.
    &quot;license_file&quot;: null,
    // String of the URL to the website for the source repository of this package.
    // May be null.
    &quot;repository&quot;: null,
    // Optional object of &quot;status&quot; badges. Each value is an object of
    // arbitrary string to string mappings.
    // crates.io has special interpretation of the format of the badges.
    &quot;badges&quot;: {
        &quot;travis-ci&quot;: {
            &quot;branch&quot;: &quot;master&quot;,
            &quot;repository&quot;: &quot;rust-lang/cargo&quot;
        }
    },
    // The `links` string value from the package's manifest, or null if not
    // specified. This field is optional and defaults to null.
    &quot;links&quot;: null
}
</code></pre>
<p>成功的响应包括JSON对象：</p>
<pre><code class="language-javascript">{
    // Optional object of warnings to display to the user.
    &quot;warnings&quot;: {
        // Array of strings of categories that are invalid and ignored.
        &quot;invalid_categories&quot;: [],
        // Array of strings of badge names that are invalid and ignored.
        &quot;invalid_badges&quot;: [],
        // Array of strings of arbitrary warnings to display to the user.
        &quot;other&quot;: []
    }
}
</code></pre>
<h4 id="yank"><a class="header" href="#yank">Yank</a></h4>
<ul>
<li>终点：<code>/api/v1/crates/{crate_name}/{version}/yank</code></li>
<li>方法：删除</li>
<li>授权：包括</li>
</ul>
<p>yank端点将设置<code>yank</code>指定箱子版本的字段<code>true</code>在索引中。</p>
<p>成功的响应包括JSON对象：</p>
<pre><code class="language-javascript">{
    // Indicates the delete succeeded, always true.
    &quot;ok&quot;: true,
}
</code></pre>
<h4 id="unyank"><a class="header" href="#unyank">Unyank</a></h4>
<ul>
<li>终点：<code>/api/v1/crates/{crate_name}/{version}/unyank</code></li>
<li>方法：放</li>
<li>授权：包括</li>
</ul>
<p>unyank端点将设置<code>yank</code>指定箱子版本的字段<code>false</code>在索引中。</p>
<p>成功的响应包括JSON对象：</p>
<pre><code class="language-javascript">{
    // Indicates the delete succeeded, always true.
    &quot;ok&quot;: true,
}
</code></pre>
<h4 id="owners"><a class="header" href="#owners">Owners</a></h4>
<p>Cargo没有用户和所有者的固有概念，但它确实提供了<code>owner</code>协助管理有权控制箱子的人员的命令。由注册中心决定用户和所有者的具体处理方式。看到了吗<a href="publishing.html#cargo-owner">publishing documentation</a>想了解一下<a href="https://crates.io/">crates.io</a>通过GitHub用户和团队处理所有者。</p>
<h5 id="owners-list"><a class="header" href="#owners-list">Owners: List</a></h5>
<ul>
<li>终点：<code>/api/v1/crates/{crate_name}/owners</code></li>
<li>方法：获取</li>
<li>授权：包括</li>
</ul>
<p>owners端点返回箱子所有者的列表。</p>
<p>成功的响应包括JSON对象：</p>
<pre><code class="language-javascript">{
    // Array of owners of the crate.
    &quot;users&quot;: [
        {
            // Unique unsigned 32-bit integer of the owner.
            &quot;id&quot;: 70,
            // The unique username of the owner.
            &quot;login&quot;: &quot;github:rust-lang:core&quot;,
            // Name of the owner.
            // This is optional and may be null.
            &quot;name&quot;: &quot;Core&quot;,
        }
    ]
}
</code></pre>
<h5 id="owners-add"><a class="header" href="#owners-add">Owners: Add</a></h5>
<ul>
<li>终点：<code>/api/v1/crates/{crate_name}/owners</code></li>
<li>方法：放</li>
<li>授权：包括</li>
</ul>
<p>PUT请求将向注册表发送向箱子添加新所有者的请求。如何处理请求取决于注册表。例如<a href="https://crates.io/">crates.io</a>向用户发送一个邀请，用户在添加之前必须接受该邀请。</p>
<p>请求应包括以下JSON对象：</p>
<pre><code class="language-javascript">{
    // Array of `login` strings of owners to add.
    &quot;users&quot;: [&quot;login_name&quot;]
}
</code></pre>
<p>成功的响应包括JSON对象：</p>
<pre><code class="language-javascript">{
    // Indicates the add succeeded, always true.
    &quot;ok&quot;: true,
    // A string to be displayed to the user.
    &quot;msg&quot;: &quot;user ehuss has been invited to be an owner of crate cargo&quot;
}
</code></pre>
<h5 id="owners-remove"><a class="header" href="#owners-remove">Owners: Remove</a></h5>
<ul>
<li>终点：<code>/api/v1/crates/{crate_name}/owners</code></li>
<li>方法：删除</li>
<li>授权：包括</li>
</ul>
<p>删除请求将从箱子中删除所有者。请求应包括以下JSON对象：</p>
<pre><code class="language-javascript">{
    // Array of `login` strings of owners to remove.
    &quot;users&quot;: [&quot;login_name&quot;]
}
</code></pre>
<p>成功的响应包括JSON对象：</p>
<pre><code class="language-javascript">{
    // Indicates the remove succeeded, always true.
    &quot;ok&quot;: true
}
</code></pre>
<h4 id="search"><a class="header" href="#search">Search</a></h4>
<ul>
<li>终点：<code>/api/v1/crates</code></li>
<li>方法：获取</li>
<li>查询参数：
<ul>
<li><code>q</code>：搜索查询字符串。</li>
<li><code>per_page</code>：结果数，默认为10，最大为100。</li>
</ul>
</li>
</ul>
<p>搜索请求将使用服务器上定义的条件搜索箱子。</p>
<p>成功的响应包括JSON对象：</p>
<pre><code class="language-javascript">{
    // Array of results.
    &quot;crates&quot;: [
        {
            // Name of the crate.
            &quot;name&quot;: &quot;rand&quot;,
            // The highest version available.
            &quot;max_version&quot;: &quot;0.6.1&quot;,
            // Textual description of the crate.
            &quot;description&quot;: &quot;Random number generators and other randomness functionality.\n&quot;,
        }
    ],
    &quot;meta&quot;: {
        // Total number of results available on the server.
        &quot;total&quot;: 119
    }
}
</code></pre>
<h4 id="login"><a class="header" href="#login">Login</a></h4>
<ul>
<li>终点：<code>/me</code></li>
</ul>
<p>“登录”端点不是实际的API请求。它的存在完全是为了<a href="../commands/cargo-login.html"><code>cargo login</code></a>命令显示URL，以指示用户在web浏览器中访问以登录并检索API令牌。</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../reference/external-tools.zh.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../reference/resolver.zh.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../reference/external-tools.zh.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../reference/resolver.zh.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
